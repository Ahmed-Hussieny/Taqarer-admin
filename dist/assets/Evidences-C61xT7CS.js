import{r as t,e as G,a as H,u as K,g as U,f as Z,j as s,q as J,s as Q,t as X}from"./index-BKWFdLJF.js";import{D as w,p as ss,e as es}from"./Dropdown-2xz721Yb.js";import{d as ts}from"./trash-DInxD9Qt.js";import{d as as}from"./downloadIcon-ybcdo-9v.js";import{p as ls}from"./plus2-Cc0MLBo8.js";import{D as rs,k as f}from"./index-Dy-D4uAd.js";import{P as os}from"./Pagination-CpCsC6ym.js";function cs(){const[E,F]=t.useState(1),[l,b]=t.useState(""),[o,y]=t.useState(""),[i,N]=t.useState(""),[k,C]=t.useState(""),[c,A]=t.useState(""),[O,_]=t.useState([]),[P,V]=t.useState([]),[I,R]=t.useState([]),{evidences:d,sourceFilters:m,classifications:x,yearFilters:p,numberOfPages:T}=G(e=>e.evidences),[Y,h]=t.useState(!1),[S,D]=t.useState(null),r=H(),g=K(),M=e=>{F(e),a({page:e,classification:l,source:o,year:i,custom:c})},a=async({page:e=1,classification:n="",source:j="",year:$="",custom:q=""})=>{await r(J({page:e,classification:n,source:j,year:$,custom:q}))};t.useEffect(()=>{_([{value:"",label:"الكل"},...x?x.map(e=>({value:e,label:e})):[]]),V([{value:"",label:"الكل"},...m?m.map(e=>({value:e,label:e})):[]]),R([{value:"",label:"الكل"},...p?p.map(e=>({value:e,label:e})):[]])},[x,m,p]),t.useEffect(()=>{window.scrollTo(0,0),a({page:1}),r(U("رفع الأدلة المعرفية")),r(Z(2))},[]);const v=e=>{b(e),a({classification:e,custom:c,page:1})},z=e=>{y(e),a({classification:l,source:e,custom:c,page:1})},B=e=>{N(e),a({classification:l,source:o,year:e,custom:c,page:1})},L=e=>{N(""),y(""),b(""),A(e.target.value),a({custom:e.target.value,classification:l,source:o,year:i,page:1})},u=async(e,n)=>{try{switch(n){case"edit":g(`/Dashboard/edit-evidence/${e}`);break;case"delete":D(e),h(!0);break;case"download":try{C(e),await r(Q(e))}finally{C("")}break}}catch(j){console.error(`Error handling action "${n}":`,j),f.error("حدث خطأ أثناء تنفيذ العملية")}},W=async()=>{if(!S)return;const e=await r(X(S));e.payload.success?f.success("تم حذف الدليل بنجاح"):f.error(e.payload.message),h(!1),D(null)};return s.jsxs("div",{className:"",children:[s.jsx(rs,{position:"top-center",reverseOrder:!1}),s.jsxs("div",{className:"flow-root",children:[s.jsxs("div",{className:"grid md:grid-cols-3 grid-cols-1 gap-2",children:[s.jsx("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-3 p-3 sm:p-4 rounded-lg",children:s.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[s.jsx("span",{className:"text-lg font-medium text-black whitespace-nowrap",children:"الادلة"}),s.jsx("form",{className:"flex-1",children:s.jsxs("div",{className:"relative shadow-lg rounded-lg",children:[s.jsx("div",{className:"absolute inset-y-0 start-0 flex items-center ps-3",children:s.jsx("svg",{className:"w-5 h-5 text-main_color","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 20",children:s.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"})})}),s.jsx("input",{type:"search",id:"default-search",className:"ps-10 w-full text-sm text-main_color placeholder:text-main_color border border-gray-300 rounded-lg bg-gray-50 py-2.5",placeholder:"ابحث الأن ...",onChange:L})]})})]})}),s.jsxs("div",{className:"col-span-2 gap-3 items-center rounded-lg",children:[s.jsx("div",{className:"justify-between items-center",children:s.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[s.jsx(w,{label:"نوع الدليل",options:O,selectedValue:l,onChange:v}),s.jsx(w,{label:"المصدر",options:P,selectedValue:o,onChange:z}),s.jsx(w,{label:"العام",options:I,selectedValue:i,onChange:B})]})}),s.jsxs("div",{className:"flex mt-2 col-span- items-center md:justify-end pb-3 sm:pb-4 justify-end ms-auto gap-2",children:[s.jsxs("button",{onClick:()=>g("/Dashboard/add-evidence"),className:"text-black text-sm flex items-center gap-1 rounded-lg py-2 px-3 hover:bg-green-50 bg-[#EAF7E8] transition-colors",title:"اضافة دليل",children:[s.jsx("img",{src:ss,alt:"plus",className:"w-4 h-4"}),s.jsx("span",{className:" sm:inline pe-2",children:"اضافة دليل"})]}),s.jsxs("button",{onClick:()=>g("/Dashboard/add-evidences"),className:"text-white  text-sm flex items-center gap-1 rounded-lg py-2 px-3 hover:bg-green-600 bg-[#3D9635] transition-colors",title:"اضافة مجموعة ادلة",children:[s.jsx("img",{src:ls,alt:"plus2",className:"w-4 h-4"}),s.jsx("span",{className:" sm:inline pe-2",children:"اضافة مجموعة ادلة"})]})]})]})]}),s.jsx("div",{className:"overflow-x-auto shadow ring-1 ring-black ring-opacity-5 sm:rounded-lg",children:s.jsxs("table",{className:"min-w-full divide-y border-separate  ",children:[s.jsx("thead",{className:"bg-[#EAF7E8]",children:s.jsxs("tr",{children:[s.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-3 text-right text-sm font-semibold text-gray-900  sm:pl-6",children:"اسم الدليل"}),s.jsx("th",{scope:"col",className:"px-3 py-3.5 text-right text-sm font-semibold text-gray-900 min-w-[90px]",children:"نوع الدليل"}),s.jsx("th",{scope:"col",className:"px-3 py-3.5 text-right text-sm font-semibold text-gray-900 min-w-[px]",children:"سنه الدليل"}),s.jsx("th",{scope:"col",className:"px-3 py-3.5 text-right text-sm font-semibold text-gray-900 min-w-[150px]",children:"مصدر الدليل"}),s.jsx("th",{scope:"col",className:"px-3 py-3.5 text-right text-sm font-semibold text-gray-900 min-w-[100px]",children:"خيارات"}),s.jsx("th",{scope:"col",className:"px-3 py-3.5 text-right text-sm font-semibold text-gray-900 w-10",children:"تحميل"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:d==null?void 0:d.map(e=>s.jsxs("tr",{children:[s.jsx("td",{className:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6",children:e==null?void 0:e.name}),s.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e==null?void 0:e.classification}),s.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e==null?void 0:e.year}),s.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:e==null?void 0:e.source}),s.jsx("td",{className:"whitespace-nowrap px-3 py-4 w-40 text-sm text-gray-500 min-w-[200px]",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("button",{onClick:()=>u(e==null?void 0:e._id,"edit"),className:"text-black flex items-center gap-1 rounded-lg py-2 px-3 hover:bg-gray-100 bg-[#F7F8F9] whitespace-nowrap",title:"تعديل",children:[s.jsx("img",{src:es,alt:"edit",className:"w-4 h-4"}),s.jsx("span",{children:"تعديل"})]}),s.jsx("button",{onClick:()=>u(e==null?void 0:e._id,"delete"),className:"text-red-600 p-2 rounded-lg bg-[#FFF1F1] hover:bg-red-50 flex items-center justify-center",title:"حذف",children:s.jsx("img",{className:"w-4 h-4",src:ts,alt:"delete"})})]})}),s.jsx("td",{className:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6 min-w-[150px]",children:s.jsx("button",{onClick:()=>u(e==null?void 0:e.pdfName,"download"),className:"text-black flex items-center gap-1 rounded-lg py-2 px-3 hover:bg-green-50 bg-[#EAF7E8] whitespace-nowrap",title:"تحميل",disabled:k===(e==null?void 0:e._id),children:k===(e==null?void 0:e._id)?s.jsxs("svg",{className:"animate-spin h-5 w-5 text-[#3D9635]",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):s.jsxs(s.Fragment,{children:[s.jsx("img",{src:as,alt:"download",className:"w-4 h-4"}),s.jsx("span",{children:"تحميل"})]})})})]},e==null?void 0:e._id))})]})}),s.jsx(os,{currentPage:E,numberOfPages:T,changeCurrentPage:M})]}),Y&&s.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",children:s.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[s.jsx("h2",{className:"text-xl font-bold mb-4",children:"تأكيد الحذف"}),s.jsx("p",{className:"mb-6",children:"هل أنت متأكد أنك تريد حذف هذا الدليل؟"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 space-x-4",children:[s.jsx("button",{className:"bg-gray-300 text-gray-700 px-4 py-2 rounded",onClick:()=>h(!1),children:"إلغاء"}),s.jsx("button",{className:"bg-red-500 text-white px-4 py-2 rounded",onClick:W,children:"حذف"})]})]})})]})}function gs(){return s.jsx("div",{children:s.jsx(cs,{})})}export{gs as default};
