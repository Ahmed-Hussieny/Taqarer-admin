import{r as a,e as K,u as U,a as Z,g as q,j as e,i as J,k as Q,l as X}from"./index-rvaT0sPR.js";import{D as f,p as ee,e as se}from"./Dropdown-DwCXWusz.js";import{d as ae}from"./trash-DInxD9Qt.js";import{d as te}from"./downloadIcon-ybcdo-9v.js";import{p as le}from"./plus2-Cc0MLBo8.js";import{D as ce,k as w}from"./index-DdKoro_J.js";function ne(){const[c,A]=a.useState(1),[n,N]=a.useState(""),[v,k]=a.useState(""),[d,R]=a.useState(""),[i,m]=a.useState(""),[x,o]=a.useState(""),[_,B]=a.useState([]),[O,V]=a.useState([]),[M,P]=a.useState([]),{reports:h,sourceFilters:C,nameFilters:S,yearFilters:F,numberOfPages:p}=K(s=>s.reports),[I,g]=a.useState(!1),[D,E]=a.useState(null),u=U(),b=async(s,t)=>{try{switch(t){case"edit":u(`/Dashboard/edit-report/${s}`);break;case"delete":E(s),g(!0);break;case"download":try{k(s),await r(J(s))}finally{k("")}break}}catch(y){console.error(`Error handling action "${t}":`,y),w.error("حدث خطأ أثناء تنفيذ العملية")}},T=async()=>{if(!D)return;const s=await r(Q(D));s.payload.success?w.success("تم حذف التقرير بنجاح"):w.error(s.payload.message),g(!1),E(null)},j=s=>{A(s),l({page:s,classification:n,source:i,year:x,custom:""})},r=Z(),l=async({page:s=1,classification:t="",source:y="",year:W="",custom:G=""})=>{const H=await r(X({page:s,classification:t,source:y,year:W,custom:G}));console.log(H.payload)};a.useEffect(()=>{B([{value:"",label:"الكل"},...S.map(s=>({value:s,label:s}))]),V([{value:"",label:"الكل"},...C.map(s=>({value:s,label:s}))]),P([{value:"",label:"الكل"},...F.map(s=>({value:s,label:s}))])},[S,C,F]),a.useLayoutEffect(()=>{window.scrollTo(0,0),l({page:1}),r(q("رفع التقارير"))},[]);const Y=s=>{N(s),m(""),o(""),l({classification:s})},$=s=>{m(s),o(""),l({source:s,classification:n,custom:d,page:1})},L=s=>{o(s),l({year:s,classification:n,source:i,custom:d,page:1})},z=s=>{o(""),m(""),N(""),R(s.target.value),l({custom:s.target.value,classification:n,source:i,year:x,page:1})};return e.jsxs("div",{className:"",children:[e.jsx(ce,{position:"top-center",reverseOrder:!1}),e.jsxs("div",{className:"flow-root",children:[e.jsxs("div",{className:"grid md:grid-cols-3 grid-cols-1 gap-2",children:[e.jsx("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-3 p-3 sm:p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("span",{className:"text-lg font-medium text-black whitespace-nowrap",children:"التقارير"}),e.jsx("form",{className:"flex-1",children:e.jsxs("div",{className:"relative shadow-lg rounded-lg",children:[e.jsx("div",{className:"absolute inset-y-0 start-0 flex items-center ps-3",children:e.jsx("svg",{className:"w-5 h-5 text-main_color","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 20",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"})})}),e.jsx("input",{type:"search",id:"default-search",value:d,className:"ps-10 w-full text-sm text-main_color placeholder:text-main_color border border-gray-300 rounded-lg bg-gray-50 py-2.5",placeholder:"ابحث الأن ...",onChange:z})]})})]})}),e.jsxs("div",{className:"col-span-2 gap-3 items-center rounded-lg",children:[e.jsx("div",{className:"justify-between items-center",children:e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx(f,{label:"نوع التقرير",options:_,selectedValue:n,onChange:Y}),e.jsx(f,{label:"المصدر",options:O,selectedValue:i,onChange:$}),e.jsx(f,{label:"العام",options:M,selectedValue:x,onChange:L})]})}),e.jsxs("div",{className:"flex mt-2 col-span- items-center md:justify-end pb-3 sm:pb-4 justify-end ms-auto gap-2",children:[e.jsxs("button",{onClick:()=>u("/Dashboard/add-report"),className:"text-black text-sm flex items-center gap-1 rounded-lg py-2 px-3 hover:bg-green-50 bg-[#EAF7E8] transition-colors",title:"اضافة تقرير",children:[e.jsx("img",{src:ee,alt:"plus",className:"w-4 h-4"}),e.jsx("span",{className:" sm:inline pe-2",children:"اضافة تقرير"})]}),e.jsxs("button",{onClick:()=>u("/Dashboard/add-reports"),className:"text-white  text-sm flex items-center gap-1 rounded-lg py-2 px-3 hover:bg-green-600 bg-[#3D9635] transition-colors",title:"اضافة مجموعة تقارير",children:[e.jsx("img",{src:le,alt:"plus2",className:"w-4 h-4"}),e.jsx("span",{className:" sm:inline pe-2",children:"اضافة مجموعة تقارير"})]})]})]})]}),e.jsx("div",{className:"overflow-x-auto shadow ring-1 ring-black ring-opacity-5 sm:rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y border-separate  ",children:[e.jsx("thead",{className:"bg-[#EAF7E8]",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-3 text-right text-sm font-semibold text-gray-900  sm:pl-6",children:"اسم التقرير"}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-right text-sm font-semibold text-gray-900 min-w-[150px]",children:"مصدر التقرير"}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-right text-sm font-semibold text-gray-900 min-w-[px]",children:"سنه التقرير"}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-right text-sm font-semibold text-gray-900 min-w-[90px]",children:"نوع التقرير"}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-right text-sm font-semibold text-gray-900 min-w-[100px]",children:"خيارات"}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-right text-sm font-semibold text-gray-900 w-10",children:"تحميل"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:h==null?void 0:h.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6",children:s==null?void 0:s.name}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:s==null?void 0:s.source}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:s==null?void 0:s.year}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-500",children:s==null?void 0:s.classification}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 w-40 text-sm text-gray-500 min-w-[200px]",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>b(s==null?void 0:s._id,"edit"),className:"text-black flex items-center gap-1 rounded-lg py-2 px-3 hover:bg-gray-100 bg-[#F7F8F9] whitespace-nowrap",title:"تعديل",children:[e.jsx("img",{src:se,alt:"edit",className:"w-4 h-4"}),e.jsx("span",{children:"تعديل"})]}),e.jsx("button",{onClick:()=>b(s==null?void 0:s._id,"delete"),className:"text-red-600 p-2 rounded-lg bg-[#FFF1F1] hover:bg-red-50 flex items-center justify-center",title:"حذف",children:e.jsx("img",{className:"w-4 h-4",src:ae,alt:"delete"})})]})}),e.jsx("td",{className:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6 min-w-[150px]",children:e.jsx("button",{onClick:()=>b(s==null?void 0:s.pdfName,"download"),className:"text-black flex items-center gap-1 rounded-lg py-2 px-3 hover:bg-green-50 bg-[#EAF7E8] whitespace-nowrap",title:"تحميل",disabled:v===s._id,children:v===s._id?e.jsxs("svg",{className:"animate-spin h-5 w-5 text-[#3D9635]",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e.jsxs(e.Fragment,{children:[e.jsx("img",{src:te,alt:"download",className:"w-4 h-4"}),e.jsx("span",{children:"تحميل"})]})})})]},s==null?void 0:s._id))})]})}),e.jsxs("div",{className:"flex justify-center items-center mt-8 mb-4",dir:"rtl",children:[e.jsx("button",{onClick:()=>j(Math.max(1,c-1)),disabled:c===1,className:"px-3 py-1 bg-[#BBC3CF]  text-black hover:bg-gray-100 rounded-s-lg disabled:opacity-50","aria-label":"الصفحة السابقة",children:"< "}),[...Array(p)].map((s,t)=>e.jsx("button",{onClick:()=>j(t+1),className:`px-3 py-1 flex items-center justify-center ${c===t+1?"bg-[#BBC3CF]  text-black border":"text-black bg-[#F7F8F9] border border-1/2 border-slate-300"}`,"aria-label":`الصفحة ${t+1}`,children:e.jsx("span",{children:t+1})},t+1)),e.jsx("button",{onClick:()=>j(Math.min(p,c+1)),disabled:c===p,className:"px-3 py-1 bg-[#BBC3CF]  text-black hover:bg-gray-100 rounded-l-lg disabled:opacity-50","aria-label":"الصفحة التالية",children:"> "})]})]}),I&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"تأكيد الحذف"}),e.jsx("p",{className:"mb-6",children:"هل أنت متأكد أنك تريد حذف هذا التقرير ؟"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 space-x-4",children:[e.jsx("button",{className:"bg-gray-300 text-gray-700 px-4 py-2 rounded",onClick:()=>g(!1),children:"إلغاء"}),e.jsx("button",{className:"bg-red-500 text-white px-4 py-2 rounded",onClick:T,children:"حذف"})]})]})})]})}function he(){return e.jsx("div",{children:e.jsx(ne,{})})}export{he as default};
