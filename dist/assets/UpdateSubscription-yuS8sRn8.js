import{a as j,u as N,b as v,r as d,g as k,j as e,ac as w,ad as F}from"./index-rvaT0sPR.js";import{F as P,c as R,e as O,g as a,E as r,h as q,f as c,i as S,a as l}from"./index.esm-DxLJxr9A.js";import{d as E}from"./trash-DInxD9Qt.js";import{D as I,k as u}from"./index-DdKoro_J.js";const $={name:"",price:0,duration:0,description:"",features:[""],maxNumberOfReports:0},V=R({name:l().required("حقل الاسم مطلوب"),price:c().required("حقل السعر مطلوب").positive("يجب أن يكون السعر رقمًا موجبًا"),duration:c().required("حقل المدة مطلوب").positive("يجب أن تكون المدة رقمًا موجبًا"),description:l().required("حقل الوصف مطلوب"),features:S().of(l().required("حقل الميزة مطلوب")).min(1,"يجب إضافة ميزة واحدة على الأقل"),maxNumberOfReports:c().required("حقل الحد الأقصى للتقارير مطلوب").positive("يجب أن يكون الحد الأقصى للتقارير رقمًا موجبًا")}),U=()=>{const o=j(),x=N(),{subscriptionId:i}=v(),[f,p]=d.useState($),[b,g]=d.useState(!0),h=async()=>{var t;if(i)try{const{payload:s}=await o(w({id:i}));if(s.paymentPackage){const n=((t=s.paymentPackage.features)==null?void 0:t.length)>0?s.paymentPackage.features:[""];p({...s.paymentPackage,features:n})}}catch{u.error("فشل في تحميل بيانات الاشتراك")}finally{g(!1)}};d.useEffect(()=>{o(k("تعديل الخطة")),h()},[i]);const y=async t=>{if(!i)return;const s=await o(F({id:i,...t}));s.payload.success?(u.success("تم التحديث بنجاح"),x(-1)):u.error(s.payload.message)};return b?e.jsx("div",{children:"جار التحميل..."}):e.jsxs("div",{className:"p-4 rtl",dir:"rtl",children:[e.jsx(I,{position:"top-center",reverseOrder:!1}),e.jsx(P,{initialValues:f,validationSchema:V,onSubmit:y,enableReinitialize:!0,children:({values:t})=>e.jsxs(O,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"الاسم"}),e.jsx(a,{type:"text",id:"name",name:"name",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),e.jsx(r,{name:"name",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700",children:"السعر"}),e.jsx(a,{type:"number",id:"price",name:"price",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),e.jsx(r,{name:"price",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"duration",className:"block text-sm font-medium text-gray-700",children:"المدة (بالأيام)"}),e.jsx(a,{type:"number",id:"duration",name:"duration",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),e.jsx(r,{name:"duration",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"الوصف"}),e.jsx(a,{as:"textarea",id:"description",name:"description",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),e.jsx(r,{name:"description",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"features",className:"block text-sm font-medium text-gray-700",children:"الميزات"}),e.jsx(q,{name:"features",children:({push:s,remove:n})=>e.jsxs("div",{children:[t.features.map((C,m)=>e.jsxs("div",{className:"flex gap-1 space-x-2 mt-2",children:[e.jsx(a,{type:"text",name:`features[${m}]`,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),e.jsx("button",{type:"button",onClick:()=>n(m),className:"inline-flex items-center ms-2 px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-white hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:e.jsx("img",{src:E,alt:"delete",className:"w-4 h-4"})})]},m)),e.jsx("button",{type:"button",onClick:()=>s(""),className:"mt-2 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-main_color hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"إضافة ميزة"})]})}),e.jsx(r,{name:"features",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"maxNumberOfReports",className:"block text-sm font-medium text-gray-700",children:"الحد الأقصى للتقارير"}),e.jsx(a,{type:"number",id:"maxNumberOfReports",name:"maxNumberOfReports",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),e.jsx(r,{name:"maxNumberOfReports",component:"div",className:"text-red-500 text-sm"})]}),e.jsx("button",{type:"submit",className:"inline-flex justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-main_color hover:opacity-90 w-full focus:outline-none focus:ring-2 focus:ring-offset-2",children:"إرسال"})]})})]})};export{U as default};
