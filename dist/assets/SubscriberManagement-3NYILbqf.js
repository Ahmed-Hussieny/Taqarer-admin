import{a as P,r as t,e as T,g as A,f as B,j as e,a5 as V,a6 as M,a7 as H}from"./index-BKWFdLJF.js";import{d as O}from"./trash-DInxD9Qt.js";import{D as Z,k as r}from"./index-Dy-D4uAd.js";import{P as z}from"./Pagination-CpCsC6ym.js";const N="data:image/svg+xml,%3csvg%20width='21'%20height='20'%20viewBox='0%200%2021%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M7.56637%202.86001C8.88956%200.568192%2011.8201%20-0.217041%2014.1119%201.10614C16.4037%202.42932%2017.189%205.35986%2015.8658%207.65168L15.7757%207.80776C16.8442%209.58282%2017.0255%2011.8213%2016.126%2013.8065C15.995%2014.0957%2015.8117%2014.4132%2015.4945%2014.9625L15.4619%2015.0191C15.424%2015.0847%2015.3847%2015.1529%2015.3422%2015.2122C14.937%2015.7777%2014.1887%2015.9783%2013.555%2015.6911C13.4886%2015.661%2013.4205%2015.6216%2013.3549%2015.5837L8.19543%2012.6049L5.1746%2017.8371C5.00201%2018.1361%204.61977%2018.2385%204.32083%2018.0659C4.0219%2017.8933%203.91948%2017.5111%204.09207%2017.2121L7.1129%2011.9799L1.9535%209.00113C1.88784%208.96328%201.81966%208.92399%201.76038%208.88151C1.19486%208.47626%200.994354%207.72796%201.28149%207.09425C1.31159%207.02782%201.35098%206.9597%201.38892%206.8941L1.42154%206.83763C1.73872%206.28822%201.92202%205.97071%202.10699%205.71259C3.3762%203.94141%205.40487%202.97917%207.47595%203.01663L7.56637%202.86001Z'%20fill='%23F59E0B'/%3e%3c/svg%3e";function q(){const d=P(),[v,C]=t.useState(1),{clientUsers:l,numberOfPages:F}=T(s=>s.user),[m,p]=t.useState(null),[n,x]=t.useState(null),[_,i]=t.useState(!1),[o,h]=t.useState(null),c=async({page:s=1,email:a=""})=>{await d(V({page:s,email:a}))},k=s=>{c({email:s.target.value})},D=s=>{C(s),c({page:s})};t.useEffect(()=>{window.scrollTo(0,0),c({page:1}),d(A("الاشتراك")),d(B(6))},[]);const E=async s=>{try{i(!1),p(s),(await d(H(s))).payload.success?r.success("تم حذف المشترك"):r.error("لم يتم حذف المشترك")}catch{r.error("حدث خطأ أثناء الحذف")}finally{p(null)}},L=s=>{h(s),i(!0)},I=async()=>{o&&(await E(o),h(null)),i(!1)},g=async s=>{try{x(s),(await d(M(s))).payload.user.isVerified?r.success("تم تفعيل المشترك"):r.success("تم تعليق المشترك")}catch{r.error("حدث خطأ أثناء التحديث")}finally{x(null)}};return e.jsxs("div",{children:[e.jsx(Z,{position:"top-center",reverseOrder:!1}),e.jsxs("div",{className:"grid md:grid-cols-3 grid-cols-1 mb-4 gap-2",children:[e.jsx("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-3 p-3 sm:p-4 rounded-lg",children:e.jsx("div",{className:"flex items-center gap-3 flex-1",children:e.jsx("span",{className:"text-lg font-medium text-black whitespace-nowrap",children:"المشتركين"})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 col-span-2 gap-3 rounded-lg",children:[e.jsx("div",{className:"flex col-span- items-center md:justify-start w-auto justify-center",children:e.jsx("form",{className:"flex-1",children:e.jsxs("div",{className:"relative shadow-lg rounded-lg",children:[e.jsx("div",{className:"absolute inset-y-0 start-0 flex items-center ps-3",children:e.jsx("svg",{className:"w-5 h-5 text-main_color","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 20",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"})})}),e.jsx("input",{type:"search",id:"default-search",className:"ps-10 w-full text-sm text-main_color placeholder:text-main_color border border-gray-300 rounded-lg bg-[#F7F8F9] py-2.5",placeholder:"البحث عن مشترك...",onChange:k})]})})}),e.jsx("div",{className:"flex col-span- items-center md:justify-end pb-3 sm:pb-4 justify-center gap-2"})]})]}),e.jsx("div",{className:"overflow-x-auto shadow ring-1 ring-black ring-opacity-5 sm:rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y border-separate",children:[e.jsx("thead",{className:"bg-[#EAF7E8]",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"py-3.5 pl-4 pr-3 text-center text-sm font-semibold text-gray-900 sm:pl-6",children:"اسم المشترك"}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900 min-w-[90px]",children:"ايميل المشترك"}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900 min-w-[px]",children:"التحقق"}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900 min-w-[px]",children:"نوع الاشتراك"}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900 min-w-[px]",children:"قيمة الاشتراك"}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900 min-w-[px]",children:"مدة الاشتراك"}),e.jsx("th",{scope:"col",className:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900 min-w-[200px]",children:"خيارات"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:l==null?void 0:l.map(s=>{var a,u,f,j,w,y,b;return e.jsxs("tr",{children:[e.jsx("td",{className:"whitespace-nowrap py-4 pl-4 pr-3 text-center text-sm font-medium text-gray-900 sm:pl-6",children:s==null?void 0:s.username}),e.jsx("td",{className:"whitespace-nowrap py-4 pl-4 pr-3 text-center text-sm font-medium text-gray-900 sm:pl-6",children:s==null?void 0:s.email}),e.jsx("td",{className:"whitespace-nowrap py-4 pl-4 pr-3 text-center text-sm font-medium text-gray-900 sm:pl-6",children:s!=null&&s.isVerified?e.jsx("div",{className:"p-2 bg-[#C0F7F0] rounded-lg",children:"مؤكد"}):e.jsx("div",{className:"p-2 bg-[#FFD6D6] rounded-lg",children:"غير مؤكد"})}),e.jsx("td",{className:"whitespace-nowrap py-4 pl-4 pr-3 text-center text-sm font-medium text-gray-900 sm:pl-6",children:(a=s==null?void 0:s.packageId)!=null&&a.name?e.jsxs(e.Fragment,{children:["  الباقة ",(u=s==null?void 0:s.packageId)==null?void 0:u.name]}):"___"}),e.jsx("td",{className:"whitespace-nowrap py-4 pl-4 pr-3 text-center text-sm font-medium text-gray-900 sm:pl-6",children:(f=s==null?void 0:s.packageId)!=null&&f.price?e.jsxs(e.Fragment,{children:["  ",(j=s==null?void 0:s.packageId)==null?void 0:j.price,"  ريال  "]}):"___"}),e.jsxs("td",{className:"whitespace-nowrap py-4 pl-4 pr-3 text-center text-sm font-medium text-gray-900 sm:pl-6",children:[e.jsx("p",{children:(w=s==null?void 0:s.startDate)==null?void 0:w.split("T")[0]}),e.jsx("p",{children:(y=s==null?void 0:s.endDate)==null?void 0:y.split("T")[0]})]}),e.jsx("td",{className:"whitespace-nowrap px-3 py-4 w-40 text-sm text-gray-500 min-w-[200px]",children:e.jsxs("div",{className:"flex items-center gap-2",children:[s.isVerified?e.jsx("button",{onClick:()=>g(s._id),disabled:n===s._id,className:"text-[#F59E0B] flex items-center gap-1 rounded-lg py-2 px-3 hover:bg-gray-100 bg-[#FFF6E7] whitespace-nowrap",title:"تعليق",children:n===s._id?e.jsx("div",{className:"animate-spin h-5 w-5 border-2 border-current border-t-transparent rounded-full"}):e.jsxs(e.Fragment,{children:[e.jsx("img",{src:N,alt:"pin",className:"w-4 h-4"}),e.jsx("span",{children:"تعليق"})]})}):e.jsx("button",{onClick:()=>g(s._id),disabled:n===s._id,className:"text-[#F59E0B] flex items-center gap-1 rounded-lg py-2 px-3 hover:bg-gray-100 bg-[#FFF6E7] whitespace-nowrap",title:"تفعيل",children:n===s._id?e.jsx("div",{className:"animate-spin h-5 w-5 border-2 border-current border-t-transparent rounded-full"}):e.jsxs(e.Fragment,{children:[e.jsx("img",{src:N,alt:"pin",className:"w-4 h-4"}),e.jsx("span",{children:"تفعيل"})]})}),e.jsx("button",{onClick:()=>L(s._id),disabled:m===s._id,className:"text-red-600 p-2 rounded-lg bg-[#FFF1F1] hover:bg-red-50 flex items-center justify-center",title:"حذف",children:m===s._id?e.jsx("div",{className:"animate-spin h-5 w-5 border-2 border-current border-t-transparent rounded-full"}):e.jsx("img",{className:"w-4 h-4",src:O,alt:"delete"})}),_&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-6 text-center rounded-lg shadow",children:[e.jsx("h2",{className:"text-lg font-semibold ",children:"هل أنت متأكد من حذف الحساب؟"}),e.jsx("span",{className:"mb-4",children:(b=l.find(S=>S._id===o))==null?void 0:b.email}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("button",{onClick:I,className:"bg-red-600 col-span-2 text-white px-4 py-2 rounded-md mr-2",children:"نعم, حذف الحساب"}),e.jsx("button",{onClick:()=>i(!1),className:"bg-gray-300 col-span-1 px-4 py-2 rounded-md",children:"إلغاء"})]})]})})]})})]},s==null?void 0:s._id)})})]})}),e.jsx(z,{currentPage:v,numberOfPages:F,changeCurrentPage:D})]})}export{q as default};
